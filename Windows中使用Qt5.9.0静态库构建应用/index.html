<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
<title>Windows中使用Qt5.9.0静态库构建应用 | 三日</title>



<meta property="og:title" content="Windows中使用Qt5.9.0静态库构建应用">



<meta name="author" content="sanri">


<meta property="og:locale" content="zh_CH">


<meta name="description" content="三日的笔记">
<meta property="og:description" content="三日的笔记">



<link rel="canonical" href="https://engtang.net/Windows中使用Qt5.9.0静态库构建应用/">
<meta property="og:url" content="https://engtang.net/Windows中使用Qt5.9.0静态库构建应用/">



<meta property="og:site_name" content="三日" />



  <meta property="og:image" content="https://engtang.net/tale.png">
  
  



  <meta property="og:type" content="article" />
  <meta property="article:published_time" content="2017-06-09T23:25:40+08:00">



  <link rel="prev" href="https://engtang.net/VisualStudio编译Qt5.9.0静态库/">





  <meta name="twitter:card" content="summary_large_image"">
  <meta property="twitter:image" content="https://engtang.net/tale.png">



  <meta property="twitter:title" content="Windows中使用Qt5.9.0静态库构建应用">





  

  

  



  

  

  

  

  


<script type="application/ld+json">
{
  "author": {
    "@type":"Person",
	  "name":"sanri",
  },
  "description": "三日的笔记",
  "url": "https://engtang.net/Windows中使用Qt5.9.0静态库构建应用/",
  "@context":"https://schema.org",
  "@type": "BlogPosting",
  "headline": "Windows中使用Qt5.9.0静态库构建应用"
  
    
      "dateModified":"2017-06-11T17:01:00+08:00",
    
    
      "datePublished":"2017-06-09T23:25:40+08:00",
    
    "mainEntityOfPage":{
      "@type":"WebPage",
      "@id":"https://engtang.net/Windows中使用Qt5.9.0静态库构建应用/"
    },
  
}
</script>

  <link rel="stylesheet" href="https://engtang.net/main.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Libre+Baskerville:400,400i,700">

  <link rel="icon" type="image/png" sizes="32x32" href="https://engtang.net/assets/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://engtang.net/assets/favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="https://engtang.net/assets/apple-touch-icon.png">

  
    <link type="application/atom+xml" rel="alternate" href="https://engtang.net/rss.xml" title="三日" />
  

  

  
  
</head>

<body>
  
  <nav class="nav">
    <div class="nav-container">
      <a href="https://engtang.net">
        <h2 class="nav-title">三日</h2>
      </a>
      <ul>
        
          
            <li><a href="https://engtang.net">Posts</a></li>
          
            <li><a href="https://engtang.net/tags">Tags</a></li>
          
            <li><a href="https://engtang.net/about">About</a></li>
          
        
      </ul>
    </div>
  </nav>
  

  <main>
    
  <div class="post">
  	<div class="post-info">
  		<span>Written by</span> sanri<br>
  		<span>On&nbsp;</span><time datetime="2017-06-09T23:25:40+08:00">2017-06-09</time>
  	</div>
  	<h1 class="post-title">Windows中使用Qt5.9.0静态库构建应用</h1>
  	<div class="post-line"></div>
  	<p>在Windows下使用VS2015和CMake构建基于 Qt5.9.0静态库的应用程序.</p>
<span id="continue-reading"></span><h1 id="准备Qt5.9.0静态库"><a class="zola-anchor" href="#准备Qt5.9.0静态库"  aria-label="Anchor link for: 准备Qt5.9.0静态库">⋅ </a>准备Qt5.9.0静态库</h1>
<p>请参考文章 <a href="/VisualStudio%E7%BC%96%E8%AF%91Qt5.9.0%E9%9D%99%E6%80%81%E5%BA%93">VisualStudio编译Qt5.9.0静态库</a></p>
<h1 id="使用VS2015与Qt5.9.0静态库构建应用"><a class="zola-anchor" href="#使用VS2015与Qt5.9.0静态库构建应用"  aria-label="Anchor link for: 使用VS2015与Qt5.9.0静态库构建应用">⋅ </a>使用VS2015与Qt5.9.0静态库构建应用</h1>
<h2 id="安装插件Qt5Package或Qt_Visual_Studio_Tools"><a class="zola-anchor" href="#安装插件Qt5Package或Qt_Visual_Studio_Tools"  aria-label="Anchor link for: 安装插件Qt5Package或Qt_Visual_Studio_Tools">⋅ </a>安装插件Qt5Package或Qt Visual Studio Tools</h2>
<p>首先确认VS2015安装有插件 <strong>Qt5Package</strong> 或者Qt官方的插件<a href="http://doc.qt.io/qtvstools/index.html">Qt Visual Studio Tools</a>
没有的话到 &quot;扩展和更新&quot; 中寻找这两个插件.</p>
<h2 id="配置项目"><a class="zola-anchor" href="#配置项目"  aria-label="Anchor link for: 配置项目">⋅ </a>配置项目</h2>
<p>使用插件提供的模板,为了使用静态库,需要增加以下配置:</p>
<ol>
<li>在项目中找到main函数所在文件,在文件开头插入下面的代码,用于导入平台扩展库的头文件</li>
</ol>
<pre data-lang="cpp" style="background-color:#eff1f5;color:#4f5b66;" class="language-cpp "><code class="language-cpp" data-lang="cpp"><span style="color:#b48ead;">#include </span><span>&lt;</span><span style="color:#a3be8c;">QtPlugin</span><span>&gt;
</span><span style="color:#bf616a;">Q_IMPORT_PLUGIN</span><span>(QWindowsIntegrationPlugin)
</span></code></pre>
<br>
<ol start="2">
<li>
<p>在 &quot;链接器&quot; -&gt; &quot;常规&quot; -&gt; &quot;附加库目录&quot; 中,添加 &quot;$(QTDIR)\plugins\platforms&quot; 这个目录.这个目录中是平台扩展库.<br />
<br></p>
</li>
<li>
<p>在 &quot;链接器&quot; -&gt; &quot;输入&quot; -&gt; &quot;附加依赖项&quot; 中填写以下这些项.</p>
</li>
</ol>
<p><strong>debug版本</strong></p>
<pre style="background-color:#eff1f5;color:#4f5b66;"><code><span>qtmaind.lib     
</span><span>Qt5Cored.lib    
</span><span>Qt5Guid.lib    
</span><span>Qt5Widgetsd.lib    
</span><span>    
</span><span>Qt5PlatformCompositorSupportd.lib    
</span><span>Qt5FontDatabaseSupportd.lib    
</span><span>Qt5ThemeSupportd.lib    
</span><span>Qt5AccessibilitySupportd.lib    
</span><span>Qt5EventDispatcherSupportd.lib    
</span><span>qtlibpngd.lib    
</span><span>qtpcre2d.lib    
</span><span>qtfreetyped.lib    
</span><span>qtharfbuzzd.lib    
</span><span>    
</span><span>qminimald.lib    
</span><span>qoffscreend.lib    
</span><span>qwindowsd.lib    
</span><span>qdirect2dd.lib    
</span><span>    
</span><span>imm32.lib    
</span><span>winmm.lib    
</span><span>Dwmapi.lib    
</span><span>UxTheme.lib    
</span><span>Mincore.lib    
</span><span>version.lib    
</span><span>ws2_32.lib    
</span></code></pre>
<br>
<p><strong>release版本</strong></p>
<pre style="background-color:#eff1f5;color:#4f5b66;"><code><span>qtmain.lib    
</span><span>Qt5Core.lib    
</span><span>Qt5Gui.lib    
</span><span>Qt5Widgets.lib    
</span><span>    
</span><span>Qt5PlatformCompositorSupport.lib    
</span><span>Qt5FontDatabaseSupport.lib    
</span><span>Qt5ThemeSupport.lib    
</span><span>Qt5AccessibilitySupport.lib    
</span><span>Qt5EventDispatcherSupport.lib    
</span><span>qtlibpng.lib    
</span><span>qtpcre2.lib    
</span><span>qtfreetype.lib    
</span><span>qtharfbuzz.lib    
</span><span>    
</span><span>qwindows.lib    
</span><span>qoffscreen.lib    
</span><span>qdirect2d.lib    
</span><span>qminimal.lib    
</span><span>    
</span><span>imm32.lib    
</span><span>winmm.lib    
</span><span>Dwmapi.lib    
</span><span>UxTheme.lib    
</span><span>Mincore.lib    
</span><span>version.lib    
</span><span>ws2_32.lib    
</span></code></pre>
<br>
<ol start="4">
<li>
<p>根据使用的Qt5.9.0静态库的编译选项 MT 或 MD,在 &quot;代码生成&quot; -&gt; &quot;运行库&quot; 中选择 MT 或 MD.<br />
<br></p>
</li>
<li>
<p>设置完毕,编译通过就行了.<br />
<br></p>
</li>
</ol>
<h1 id="使用CMake与Qt5.9.0静态库构建Qt应用"><a class="zola-anchor" href="#使用CMake与Qt5.9.0静态库构建Qt应用"  aria-label="Anchor link for: 使用CMake与Qt5.9.0静态库构建Qt应用">⋅ </a>使用CMake与Qt5.9.0静态库构建Qt应用</h1>
<h2 id="概述"><a class="zola-anchor" href="#概述"  aria-label="Anchor link for: 概述">⋅ </a>概述</h2>
<p>Qt5对CMake的支持相当好(或者反过来说CMake对Qt5的支持也很好),经过简单配置,CMake就可以做为Qt5的构建工具.<br />
之前以为使用cmake构建qt应用会非常麻烦,需要自己调用moc和指定UI文件的编译过程.其实Qt5的库中已经提供方便使用cmake的模块与宏命令.<br />
例如:</p>
<ul>
<li>cmake 的CMAKE_AUTOMOC 变量,直接可以开启cmake在需要时自动运行moc功能.</li>
<li>Qt5提供的cmake模块中, qt5_wrap_ui 宏可以直接从UI文件创建代码.</li>
<li>使用cmake的 target_link_libraries 命令,可以用这语法直接包含Qt的库文件<pre data-lang="cmake" style="background-color:#eff1f5;color:#4f5b66;" class="language-cmake "><code class="language-cmake" data-lang="cmake"><span style="color:#96b5b4;">target_link_libraries</span><span>(
</span><span>    qt590static_test 
</span><span>    Qt5::Widgets
</span><span>)
</span></code></pre>
</li>
</ul>
<p>详情请参考Qt官方文档 <a href="http://doc.qt.io/qt-5/cmake-manual.html">Qt 5.9 CMake Manual</a>
与CMake官方文档<a href="https://cmake.org/cmake/help/v3.9/manual/cmake-qt.7.html">cmake-qt</a></p>
<h2 id="实例"><a class="zola-anchor" href="#实例"  aria-label="Anchor link for: 实例">⋅ </a>实例</h2>
<h3 id="创建文件"><a class="zola-anchor" href="#创建文件"  aria-label="Anchor link for: 创建文件">⋅ </a>创建文件</h3>
<ol>
<li>
<p>在项目目录中创建文件 qt590static_test.h.</p>
<pre data-lang="cpp" style="background-color:#eff1f5;color:#4f5b66;" class="language-cpp "><code class="language-cpp" data-lang="cpp"><span style="color:#a7adba;">// qt590static_test.h.
</span><span style="color:#b48ead;">#ifndef</span><span> QT590STATIC_TEST_H
</span><span style="color:#b48ead;">#define </span><span>QT590STATIC_TEST_H
</span><span>
</span><span style="color:#b48ead;">#include </span><span>&lt;</span><span style="color:#a3be8c;">QtWidgets/QMainWindow</span><span>&gt;
</span><span style="color:#b48ead;">#include </span><span>&quot;</span><span style="color:#a3be8c;">ui_qt590static_test.h</span><span>&quot;
</span><span>
</span><span style="color:#b48ead;">class </span><span style="color:#d08770;">qt590static_test </span><span style="color:#343d46;">: </span><span style="color:#b48ead;">public </span><span style="color:#a3be8c;">QMainWindow
</span><span style="color:#343d46;">{
</span><span style="color:#343d46;">    Q_OBJECT
</span><span style="color:#343d46;">
</span><span style="color:#b48ead;">public</span><span style="color:#343d46;">:
</span><span style="color:#343d46;">    </span><span style="color:#8fa1b3;">qt590static_test</span><span style="color:#343d46;">(QWidget </span><span>*</span><span style="color:#bf616a;">parent </span><span>= </span><span style="color:#d08770;">0</span><span style="color:#343d46;">);
</span><span style="color:#343d46;">    </span><span style="color:#8fa1b3;">~qt590static_test</span><span style="color:#343d46;">();
</span><span style="color:#343d46;">
</span><span style="color:#b48ead;">private</span><span style="color:#343d46;">:
</span><span style="color:#343d46;">    Ui::qt590static_testClass ui;
</span><span style="color:#343d46;">}</span><span>;
</span><span>
</span><span style="color:#b48ead;">#endif    
</span></code></pre>
<br>
</li>
<li>
<p>创建文件 qt590static_test.cpp</p>
<pre data-lang="cpp" style="background-color:#eff1f5;color:#4f5b66;" class="language-cpp "><code class="language-cpp" data-lang="cpp"><span style="color:#a7adba;">// qt590static_test.cpp
</span><span style="color:#b48ead;">#include </span><span>&quot;</span><span style="color:#a3be8c;">qt590static_test.h</span><span>&quot;
</span><span>
</span><span>qt590static_test::</span><span style="color:#8fa1b3;">qt590static_test</span><span>(QWidget *</span><span style="color:#bf616a;">parent</span><span>)
</span><span>    : </span><span style="color:#bf616a;">QMainWindow</span><span>(parent)
</span><span>{
</span><span>    ui.</span><span style="color:#bf616a;">setupUi</span><span>(</span><span style="color:#bf616a;">this</span><span>);
</span><span>}
</span><span>
</span><span>qt590static_test::</span><span style="color:#8fa1b3;">~qt590static_test</span><span>()
</span><span>{
</span><span>
</span><span>}
</span></code></pre>
<br>
</li>
<li>
<p>使用Qt Designer 创建文件qt590static_test.ui.<br />
也可以直接创建qt590static_test.ui文件</p>
<pre data-lang="xml" style="background-color:#eff1f5;color:#4f5b66;" class="language-xml "><code class="language-xml" data-lang="xml"><span>&lt;</span><span style="color:#bf616a;">UI </span><span style="color:#d08770;">version</span><span>=&quot;</span><span style="color:#a3be8c;">4.0</span><span>&quot; &gt;
</span><span>    &lt;</span><span style="color:#bf616a;">class</span><span>&gt;qt590static_testClass&lt;/</span><span style="color:#bf616a;">class</span><span>&gt;
</span><span>    &lt;</span><span style="color:#bf616a;">widget </span><span style="color:#d08770;">class</span><span>=&quot;</span><span style="color:#a3be8c;">QMainWindow</span><span>&quot; </span><span style="color:#d08770;">name</span><span>=&quot;</span><span style="color:#a3be8c;">qt590static_testClass</span><span>&quot; &gt;
</span><span>        &lt;</span><span style="color:#bf616a;">property </span><span style="color:#d08770;">name</span><span>=&quot;</span><span style="color:#a3be8c;">objectName</span><span>&quot; &gt;
</span><span>            &lt;</span><span style="color:#bf616a;">string </span><span style="color:#d08770;">notr</span><span>=&quot;</span><span style="color:#a3be8c;">true</span><span>&quot;&gt;qt590static_testClass&lt;/</span><span style="color:#bf616a;">string</span><span>&gt;
</span><span>        &lt;/</span><span style="color:#bf616a;">property</span><span>&gt;
</span><span>        &lt;</span><span style="color:#bf616a;">property </span><span style="color:#d08770;">name</span><span>=&quot;</span><span style="color:#a3be8c;">geometry</span><span>&quot; &gt;
</span><span>            &lt;</span><span style="color:#bf616a;">rect</span><span>&gt;
</span><span>                &lt;</span><span style="color:#bf616a;">x</span><span>&gt;0&lt;/</span><span style="color:#bf616a;">x</span><span>&gt;
</span><span>                &lt;</span><span style="color:#bf616a;">y</span><span>&gt;0&lt;/</span><span style="color:#bf616a;">y</span><span>&gt;
</span><span>                &lt;</span><span style="color:#bf616a;">width</span><span>&gt;600&lt;/</span><span style="color:#bf616a;">width</span><span>&gt;
</span><span>                &lt;</span><span style="color:#bf616a;">height</span><span>&gt;400&lt;/</span><span style="color:#bf616a;">height</span><span>&gt;
</span><span>            &lt;/</span><span style="color:#bf616a;">rect</span><span>&gt;
</span><span>        &lt;/</span><span style="color:#bf616a;">property</span><span>&gt;
</span><span>        &lt;</span><span style="color:#bf616a;">property </span><span style="color:#d08770;">name</span><span>=&quot;</span><span style="color:#a3be8c;">windowTitle</span><span>&quot; &gt;
</span><span>        &lt;</span><span style="color:#bf616a;">string</span><span>&gt;qt590static_test&lt;/</span><span style="color:#bf616a;">string</span><span>&gt;
</span><span>        &lt;/</span><span style="color:#bf616a;">property</span><span>&gt;
</span><span>    &lt;</span><span style="color:#bf616a;">widget </span><span style="color:#d08770;">class</span><span>=&quot;</span><span style="color:#a3be8c;">QMenuBar</span><span>&quot; </span><span style="color:#d08770;">name</span><span>=&quot;</span><span style="color:#a3be8c;">menuBar</span><span>&quot; /&gt;
</span><span>    &lt;</span><span style="color:#bf616a;">widget </span><span style="color:#d08770;">class</span><span>=&quot;</span><span style="color:#a3be8c;">QToolBar</span><span>&quot; </span><span style="color:#d08770;">name</span><span>=&quot;</span><span style="color:#a3be8c;">mainToolBar</span><span>&quot; /&gt;
</span><span>    &lt;</span><span style="color:#bf616a;">widget </span><span style="color:#d08770;">class</span><span>=&quot;</span><span style="color:#a3be8c;">QWidget</span><span>&quot; </span><span style="color:#d08770;">name</span><span>=&quot;</span><span style="color:#a3be8c;">centralWidget</span><span>&quot; /&gt;
</span><span>    &lt;</span><span style="color:#bf616a;">widget </span><span style="color:#d08770;">class</span><span>=&quot;</span><span style="color:#a3be8c;">QStatusBar</span><span>&quot; </span><span style="color:#d08770;">name</span><span>=&quot;</span><span style="color:#a3be8c;">statusBar</span><span>&quot; /&gt;
</span><span>    &lt;/</span><span style="color:#bf616a;">widget</span><span>&gt;
</span><span>    &lt;</span><span style="color:#bf616a;">layoutDefault </span><span style="color:#d08770;">spacing</span><span>=&quot;</span><span style="color:#a3be8c;">6</span><span>&quot; </span><span style="color:#d08770;">margin</span><span>=&quot;</span><span style="color:#a3be8c;">11</span><span>&quot; /&gt;
</span><span>    &lt;</span><span style="color:#bf616a;">pixmapfunction</span><span>&gt;&lt;/</span><span style="color:#bf616a;">pixmapfunction</span><span>&gt;
</span><span>    &lt;</span><span style="color:#bf616a;">resources</span><span>&gt;
</span><span>        &lt;</span><span style="color:#bf616a;">include </span><span style="color:#d08770;">location</span><span>=&quot;</span><span style="color:#a3be8c;">qt590static_test.qrc</span><span>&quot;/&gt;
</span><span>    &lt;/</span><span style="color:#bf616a;">resources</span><span>&gt;
</span><span>    &lt;</span><span style="color:#bf616a;">connections</span><span>/&gt;
</span><span>&lt;/</span><span style="color:#bf616a;">UI</span><span>&gt;
</span></code></pre>
<br>
</li>
<li>
<p>创建文件 main.cpp</p>
<pre data-lang="cpp" style="background-color:#eff1f5;color:#4f5b66;" class="language-cpp "><code class="language-cpp" data-lang="cpp"><span style="color:#a7adba;">// main.cpp
</span><span style="color:#b48ead;">#include </span><span>&lt;</span><span style="color:#a3be8c;">QtPlugin</span><span>&gt;
</span><span style="color:#bf616a;">Q_IMPORT_PLUGIN</span><span>(QWindowsIntegrationPlugin)
</span><span style="color:#b48ead;">#include </span><span>&quot;</span><span style="color:#a3be8c;">qt590static_test.h</span><span>&quot;
</span><span style="color:#b48ead;">#include </span><span>&lt;</span><span style="color:#a3be8c;">QtWidgets/QApplication</span><span>&gt;
</span><span>
</span><span style="color:#b48ead;">int </span><span style="color:#8fa1b3;">main</span><span>(</span><span style="color:#b48ead;">int </span><span style="color:#bf616a;">argc</span><span>, </span><span style="color:#b48ead;">char </span><span>*</span><span style="color:#bf616a;">argv</span><span>[])
</span><span>{
</span><span>    QApplication </span><span style="color:#bf616a;">a</span><span>(argc, argv);
</span><span>    qt590static_test w;
</span><span>    w.</span><span style="color:#bf616a;">show</span><span>();
</span><span>    </span><span style="color:#b48ead;">return</span><span> a.</span><span style="color:#bf616a;">exec</span><span>();
</span><span>}
</span></code></pre>
<br>
</li>
<li>
<p>创建CMake项目文件 CMakeLists.txt</p>
<pre data-lang="cmake" style="background-color:#eff1f5;color:#4f5b66;" class="language-cmake "><code class="language-cmake" data-lang="cmake"><span style="color:#96b5b4;">cmake_minimum_required</span><span>(</span><span style="color:#bf616a;">VERSION </span><span>3.0.0)
</span><span>
</span><span style="color:#a7adba;">#设定Qt静态库的目录位置
</span><span style="color:#96b5b4;">set</span><span>(</span><span style="color:#bf616a;">CMAKE_PREFIX_PATH </span><span>D:/Qt/Qt5.9.0_x64_static_msvc2015)
</span><span style="color:#a7adba;">#需要开启c++11标准
</span><span style="color:#96b5b4;">set</span><span>(</span><span style="color:#bf616a;">CMAKE_CXX_STANDARD </span><span>11)
</span><span style="color:#a7adba;"># 自动将当前源代码和构建目录添加到包含路径
</span><span style="color:#96b5b4;">set</span><span>(</span><span style="color:#bf616a;">CMAKE_INCLUDE_CURRENT_DIR </span><span>ON)
</span><span style="color:#a7adba;"># 指示CMake在需要时自动运行moc
</span><span style="color:#96b5b4;">set</span><span>(</span><span style="color:#bf616a;">CMAKE_AUTOMOC </span><span>ON)
</span><span>
</span><span style="color:#a7adba;"># 查找QtWidgets包
</span><span style="color:#96b5b4;">find_package</span><span>(Qt5Widgets)
</span><span>
</span><span style="color:#96b5b4;">project</span><span>(qt590static_test)
</span><span>
</span><span style="color:#a7adba;">#由于是使用静态库,所以需要指定部分链接库
</span><span style="color:#96b5b4;">set</span><span>(</span><span style="color:#bf616a;">QLIBDIR </span><span>&quot;</span><span style="color:#a3be8c;">D:/Qt/Qt5.9.0_x64_static_msvc2015/lib/</span><span>&quot;)
</span><span style="color:#96b5b4;">set</span><span>(</span><span style="color:#bf616a;">QPLADIR </span><span>&quot;</span><span style="color:#a3be8c;">D:/Qt/Qt5.9.0_x64_static_msvc2015/plugins/platforms/</span><span>&quot;)
</span><span>
</span><span style="color:#b48ead;">if</span><span>(CMAKE_BUILD_TYPE </span><span style="color:#bf616a;">STREQUAL </span><span>Debug)
</span><span>    </span><span style="color:#a7adba;">#Debug 版本需要链接的库
</span><span>    </span><span style="color:#96b5b4;">set</span><span>(</span><span style="color:#bf616a;">QLIBS 
</span><span>        ${</span><span style="color:#bf616a;">QLIBDIR</span><span>}Qt5PlatformCompositorSupportd.lib
</span><span>        ${</span><span style="color:#bf616a;">QLIBDIR</span><span>}Qt5FontDatabaseSupportd.lib
</span><span>        ${</span><span style="color:#bf616a;">QLIBDIR</span><span>}Qt5ThemeSupportd.lib
</span><span>        ${</span><span style="color:#bf616a;">QLIBDIR</span><span>}Qt5AccessibilitySupportd.lib
</span><span>        ${</span><span style="color:#bf616a;">QLIBDIR</span><span>}Qt5EventDispatcherSupportd.lib
</span><span>        ${</span><span style="color:#bf616a;">QLIBDIR</span><span>}qtlibpngd.lib
</span><span>        ${</span><span style="color:#bf616a;">QLIBDIR</span><span>}qtfreetyped.lib
</span><span>        ${</span><span style="color:#bf616a;">QLIBDIR</span><span>}qtpcre2d.lib
</span><span>        ${</span><span style="color:#bf616a;">QLIBDIR</span><span>}qtharfbuzzd.lib
</span><span>
</span><span>        ${</span><span style="color:#bf616a;">QPLADIR</span><span>}qminimald.lib
</span><span>        ${</span><span style="color:#bf616a;">QPLADIR</span><span>}qoffscreend.lib
</span><span>        ${</span><span style="color:#bf616a;">QPLADIR</span><span>}qwindowsd.lib
</span><span>        ${</span><span style="color:#bf616a;">QPLADIR</span><span>}qdirect2dd.lib
</span><span>    )
</span><span style="color:#b48ead;">elseif</span><span>(CMAKE_BUILD_TYPE </span><span style="color:#bf616a;">STREQUAL </span><span>Release)
</span><span>    </span><span style="color:#a7adba;">#Release 版本需要链接的库
</span><span>    </span><span style="color:#96b5b4;">set</span><span>(</span><span style="color:#bf616a;">QLIBS 
</span><span>        ${</span><span style="color:#bf616a;">QLIBDIR</span><span>}Qt5PlatformCompositorSupport.lib
</span><span>        ${</span><span style="color:#bf616a;">QLIBDIR</span><span>}Qt5FontDatabaseSupport.lib
</span><span>        ${</span><span style="color:#bf616a;">QLIBDIR</span><span>}Qt5ThemeSupport.lib
</span><span>        ${</span><span style="color:#bf616a;">QLIBDIR</span><span>}Qt5AccessibilitySupport.lib
</span><span>        ${</span><span style="color:#bf616a;">QLIBDIR</span><span>}Qt5EventDispatcherSupport.lib
</span><span>        ${</span><span style="color:#bf616a;">QLIBDIR</span><span>}qtlibpng.lib
</span><span>        ${</span><span style="color:#bf616a;">QLIBDIR</span><span>}qtfreetype.lib
</span><span>        ${</span><span style="color:#bf616a;">QLIBDIR</span><span>}qtpcre2.lib
</span><span>        ${</span><span style="color:#bf616a;">QLIBDIR</span><span>}qtharfbuzz.lib
</span><span>
</span><span>        ${</span><span style="color:#bf616a;">QPLADIR</span><span>}qminimal.lib
</span><span>        ${</span><span style="color:#bf616a;">QPLADIR</span><span>}qoffscreen.lib
</span><span>        ${</span><span style="color:#bf616a;">QPLADIR</span><span>}qwindows.lib
</span><span>        ${</span><span style="color:#bf616a;">QPLADIR</span><span>}qdirect2d.lib
</span><span>    )
</span><span style="color:#b48ead;">else</span><span>(CMAKE_BUILD_TYPE </span><span style="color:#bf616a;">STREQUAL </span><span>Debug)
</span><span>    </span><span style="color:#96b5b4;">message</span><span>(</span><span style="color:#bf616a;">FATAL_ERROR </span><span>&quot;</span><span style="color:#a3be8c;">please set CMAKE_BUILD_TYPE = Debug | Release</span><span>&quot;)
</span><span style="color:#b48ead;">endif</span><span>(CMAKE_BUILD_TYPE </span><span style="color:#bf616a;">STREQUAL </span><span>Debug)
</span><span>
</span><span style="color:#a7adba;">#从ui文件创建cpp代码,需要编译的UI文件都必须使用这条宏引入项目中
</span><span style="color:#bf616a;">qt5_wrap_ui</span><span>(ui_qt590static_test.h qt590static_test.ui)
</span><span>
</span><span style="color:#96b5b4;">add_executable</span><span>(
</span><span>    qt590static_test 
</span><span>    </span><span style="color:#bf616a;">WIN32 
</span><span>    main.cpp 
</span><span>    qt590static_test.cpp 
</span><span>    qt590static_test.ui
</span><span>)
</span><span>
</span><span style="color:#96b5b4;">target_link_libraries</span><span>(
</span><span>    qt590static_test 
</span><span>
</span><span>    Qt5::Widgets
</span><span>
</span><span>    ${</span><span style="color:#bf616a;">QLIBS</span><span>}
</span><span>
</span><span>    imm32.lib
</span><span>    winmm.lib
</span><span>    Dwmapi.lib
</span><span>    UxTheme.lib
</span><span>    Mincore.lib
</span><span>    version.lib
</span><span>    ws2_32.lib
</span><span>)
</span></code></pre>
<br>
</li>
</ol>
<h3 id="编译项目"><a class="zola-anchor" href="#编译项目"  aria-label="Anchor link for: 编译项目">⋅ </a>编译项目</h3>
<ol>
<li>
<p>使用 <strong>VS2015 x64 本机工具命令提示符</strong> 进入项目目录.<br />
最好创建构建目录build_x64_Debug 与build_x64_Release,好分开构建Debug与Release版本.</p>
</li>
<li>
<p>进入构建目录,例如进入build_x64_Debug 后,执行命令:</p>
<pre data-lang="cmd" style="background-color:#eff1f5;color:#4f5b66;" class="language-cmd "><code class="language-cmd" data-lang="cmd"><span>cmake .. -G &quot;</span><span style="color:#a3be8c;">NMake Makefiles</span><span>&quot; -DCMAKE_BUILD_TYPE=</span><span style="color:#b48ead;">Debug
</span></code></pre>
<p>当然,也可以使用VS IDE,那么就使用命令:</p>
<pre data-lang="cmd" style="background-color:#eff1f5;color:#4f5b66;" class="language-cmd "><code class="language-cmd" data-lang="cmd"><span>cmake .. -G &quot;</span><span style="color:#a3be8c;">Visual Studio 14 2015 Win64</span><span>&quot; -DCMAKE_BUILD_TYPE=</span><span style="color:#b48ead;">Debug
</span></code></pre>
</li>
<li>
<p>编译项目,使用命令:</p>
<pre data-lang="cmd" style="background-color:#eff1f5;color:#4f5b66;" class="language-cmd "><code class="language-cmd" data-lang="cmd"><span>nmake
</span></code></pre>
<p>或者使用VS IDE打开项目并编译.</p>
</li>
<li>
<p>OK,构建成功</p>
</li>
</ol>

  </div>

	

  <div class="pagination">
  	<a href="https://engtang.net/macOS下使用CLion远程开发调试Linux上的QtGUI程序/" class="left arrow">&#8592;</a>
		<a href="#" class="top">Top</a>
		<a href="https://engtang.net/VisualStudio编译Qt5.9.0静态库/" class="right arrow">&#8594;</a>
  </div>

  </main>

  
  <footer>
    <span>&copy; <time datetime="2021-09-08T22:47:23.882471+08:00">2017-2021</time> sanri. Made with <a href="https://www.getzola.org">Zola</a> with <a href="https://github.com/aaranxu/tale-zola">Tala-Zola</a> theme.</span>
  </footer>
  
</body>
</html>
